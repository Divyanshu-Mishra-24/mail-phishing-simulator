ðŸ“— SYSTEM DESIGN DOCUMENT
1. Architecture Overview
User â†’ Frontend Dashboard â†’ Backend API
                               â†“
                        Email Connector
                               â†“
                        Analysis Engine
                     (Rules + ML + URL Scan)
                               â†“
                        Risk Scoring Engine
                               â†“
                          Metrics DB

2. Modules
2.1 Frontend Module

Login/connect mailbox

Trigger scan

Dashboard charts

Exposure settings UI

2.2 Email Connector Module

Supports:

Gmail OAuth API

Outlook Graph API

IMAP app password

Functions:

connect_mailbox()
fetch_recent_emails(N)
extract_fields()

2.3 Analysis Engine

Sub-components:

URL Analyzer

suspicious TLD

IP URLs

shorteners

typosquatting

Content Analyzer

phishing phrases

urgency keywords

credential requests

Sender Analyzer

domain mismatch

spoof display name

ML Classifier

vectorizer + model

phishing probability

2.4 Risk Scoring Engine

Example weighted formula:

risk_score =
  0.35 * ML_probability +
  0.25 * URL_risk +
  0.20 * sender_risk +
  0.20 * content_flags

2.5 Database Design
Table: email_risk_metrics
Field	Type
id	int
user_id	hash
msg_hash	hash
timestamp	datetime
risk_score	int
risk_level	text
factors	json
2.6 Security Design

Token encryption

Hash email IDs

No body storage

Role-based API access

3. Data Flow
User connects mailbox
â†’ Token stored encrypted
â†’ Emails fetched
â†’ Parsed in memory
â†’ Features extracted
â†’ ML + rule scoring
â†’ Risk score computed
â†’ Metrics stored
â†’ Email content discarded
â†’ Dashboard updated

4. API Design (Example)
POST /connect
POST /scan
GET /results
GET /dashboard
POST /settings

5. Tech Stack Recommendation

Backend: Python FastAPI
Frontend: React
ML: sklearn
DB: PostgreSQL
Auth: OAuth2
Email: Gmail API / IMAP
Charts: Chart.js

6. Future Enhancements

Real-time mailbox monitoring

Domain reputation feeds

Threat intelligence API

Attachment sandbox scan

Organization-wide risk scoring